{"version":3,"file":"ngx-progressbar-http.js","sources":["ng:/ngx-progressbar/http/ng-progress-http.interface.ts","ng:/ngx-progressbar/http/ng-progress.interceptor.ts","ng:/ngx-progressbar/http/ng-progress-http.module.ts","ng:/ngx-progressbar/http/ngx-progressbar-http.ts"],"names":[],"mappings":"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","sourcesContent":["import { InjectionToken } from '@angular/core';\n\nexport interface NgProgressHttpConfig {\n  id?: string;\n  silentApis?: string[];\n}\n\nexport const NG_PROGRESS_HTTP_CONFIG = new InjectionToken<NgProgressHttpConfig>('ngProgressHttpConfig');\n","import { Injectable, Optional, Inject } from '@angular/core';\nimport { HttpInterceptor, HttpEvent, HttpHandler, HttpRequest } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { finalize } from 'rxjs/operators';\nimport { NgProgress, NgProgressRef } from 'ngx-progressbar';\n// import { NgProgress, NgProgressRef } from '../../src/public-api';\nimport { NgProgressHttpConfig, NG_PROGRESS_HTTP_CONFIG } from './ng-progress-http.interface';\n\n@Injectable()\nexport class NgProgressInterceptor implements HttpInterceptor {\n\n  private _inProgressCount = 0;\n  private _progressRef: NgProgressRef;\n  private readonly _config: NgProgressHttpConfig = {\n    id: 'root',\n    silentApis: []\n  };\n\n  constructor(ngProgress: NgProgress, @Optional() @Inject(NG_PROGRESS_HTTP_CONFIG) config?: NgProgressHttpConfig) {\n    this._config = config ? {...this._config, ...config} : this._config;\n    this._progressRef = ngProgress.ref(this._config.id);\n  }\n\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\n    // Ignore by request headers\n    if (req.headers.has('ignoreProgressBar')) {\n      return next.handle(req.clone({headers: req.headers.delete('ignoreProgressBar')}));\n    }\n\n    // Ignore silent api requests\n    if (this.checkUrl(req)) {\n      return next.handle(req);\n    }\n\n    this._inProgressCount++;\n\n    if (!this._progressRef.isStarted) {\n      this._progressRef.start();\n    }\n\n    return next.handle(req).pipe(\n      finalize(() => {\n        this._inProgressCount--;\n        if (this._inProgressCount === 0) {\n          this._progressRef.complete();\n        }\n      })\n    );\n  }\n\n  /**\n   * Check if request is silent.\n   * @param req request\n   */\n  private checkUrl(req: HttpRequest<any>) {\n    const url = req.url.toLowerCase();\n    const found = this._config.silentApis.find((u) => url.startsWith(u));\n    return !!found;\n  }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { NgProgressInterceptor } from './ng-progress.interceptor';\nimport { NgProgressHttpConfig, NG_PROGRESS_HTTP_CONFIG } from './ng-progress-http.interface';\n\n@NgModule({\n  providers: [\n    { provide: HTTP_INTERCEPTORS, useClass: NgProgressInterceptor, multi: true }\n  ]\n})\nexport class NgProgressHttpModule {\n  static withConfig(config: NgProgressHttpConfig): ModuleWithProviders<NgProgressHttpModule> {\n    return {\n      ngModule: NgProgressHttpModule,\n      providers: [\n        { provide: NG_PROGRESS_HTTP_CONFIG, useValue: config }\n      ]\n    };\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {NgProgressInterceptor as Éµa} from './ng-progress.interceptor';"]}